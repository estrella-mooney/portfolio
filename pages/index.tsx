// import getPosts from './api/getPosts'
import Head from 'next/head'
import { BsFillMoonStarsFill } from 'react-icons/bs'
import { useState, useEffect } from 'react'
import Intro from './Components/Intro'
import Projects from './Components/Projects'

export async function getPosts() {
  console.log('hello is anything even working?')
  const res = await fetch('http://localhost:3000/api/getPosts')
  if (!res.ok) {
    console.log('Response status', res.status)
    throw new Error('Failed to retrieve posts')
  }
  const data = await res.json()
  console.log('API response:', data)
  return data
}

export default async function Home() {
  const [darkMode, setDarkMode] = useState(true)
  const [posts, setPosts] = useState([])

  const data: {
    id: number
    title: string
    content: string
    tech_used: string
    reflection: string
  }[] = await getPosts()
  console.log('Received data:', data)

  // useEffect(() => {
  //   async function fetchPosts() {
  //     try {
  //       const data = await getPosts()
  //       setPosts(data)
  //     } catch (error) {
  //       console.error(error)
  //     }
  //   }

  //   fetchPosts()
  // }, [])

  return (
    <div className={darkMode ? 'dark' : ''}>
      <Head>
        <title>Estrella&apos;s portfolio</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="bg-indigo-100  dark:bg-gray-900  min-h-screen md:px-28 lg:px-48 xl:px-10 2xl:px-7">
        <section className="mb-24 sm:mb-16">
          <nav className="py-10 mb-4 flex justify-between  dark:text-white">
            <h1 className="font-semibold text-2xl">Estrella</h1>

            <ul className="flex items-center">
              <li className="pr-5">
                <a href="../estrella-CV.pdf" target="_blank">
                  <button>CV</button>
                </a>
              </li>
              <li>
                <BsFillMoonStarsFill
                  onClick={() => setDarkMode(!darkMode)}
                  className=" cursor-pointer text-2xl"
                />
              </li>
            </ul>
          </nav>
        </section>
        <Intro />
        <Projects />
      </main>
    </div>
  )
}
